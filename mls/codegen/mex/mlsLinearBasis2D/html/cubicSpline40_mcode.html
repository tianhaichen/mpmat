<pre class="code">
<span class="srcline"><span class="lineno"><a href="33,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">w</span>,<span class="var type1" id="S3T3U4">dwdr</span>] = cubicSpline(<span class="var type1" id="S4T3U7">r</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="33,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Compute cubic spline function</span></span></span>
<span class="srcline"><span class="lineno"><a href="33,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="33,4" id="srcline4"> 4</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T9:U4"><span class="var type1" id="S4T3U12">r</span> &lt;= <span class="mxinfo " id="T3:U6">0.5</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="33,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo " id="T3:U7"><span class="var type1" id="S2T3U16">w</span>    = <span class="mxinfo " id="T3:U9"><span class="mxinfo " id="T3:U10"><span class="mxinfo " id="T3:U11"><span class="mxinfo " id="T3:U12">2</span>/<span class="mxinfo " id="T3:U13">3</span></span> - <span class="mxinfo " id="T3:U14"><span class="mxinfo " id="T3:U15"><span class="mxinfo " id="T3:U16">4</span>*<span class="var type1" id="S4T3U25">r</span></span>*<span class="var type1" id="S4T3U26">r</span></span></span> + <span class="mxinfo " id="T3:U19"><span class="mxinfo " id="T3:U20"><span class="mxinfo " id="T3:U21"><span class="mxinfo " id="T3:U22">4</span>*<span class="var type1" id="S4T3U31">r</span></span>*<span class="var type1" id="S4T3U32">r</span></span>*<span class="var type1" id="S4T3U33">r</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T3:U26"><span class="var type1" id="S3T3U36">dwdr</span> = <span class="mxinfo " id="T3:U28"><span class="mxinfo " id="T3:U29"><span class="mxinfo " id="T3:U30">-8</span>*<span class="var type1" id="S4T3U41">r</span></span> + <span class="mxinfo " id="T3:U32"><span class="mxinfo " id="T3:U33"><span class="mxinfo " id="T3:U34">12</span>*<span class="var type1" id="S4T3U45">r</span></span>*<span class="var type1" id="S4T3U46">r</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">elseif</span> (<span class="mxinfo " id="T9:U37"><span class="var type1" id="S4T3U51">r</span> &gt; <span class="mxinfo " id="T3:U39">0.5</span></span>) &amp;&amp; (<span class="mxinfo " id="T9:U40"><span class="var type1" id="S4T3U55">r</span> &lt;= <span class="mxinfo " id="T3:U42">1.0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="33,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T3:U43"><span class="var type1" id="S2T3U59">w</span>    = <span class="mxinfo " id="T3:U45"><span class="mxinfo " id="T3:U46"><span class="mxinfo " id="T3:U47"><span class="mxinfo " id="T3:U48"><span class="mxinfo " id="T3:U49">4</span>/<span class="mxinfo " id="T3:U50">3</span></span> - <span class="mxinfo " id="T3:U51"><span class="mxinfo " id="T3:U52">4</span>*<span class="var type1" id="S4T3U68">r</span></span></span> + <span class="mxinfo " id="T3:U54"><span class="mxinfo " id="T3:U55"><span class="mxinfo " id="T3:U56">4</span>*<span class="var type1" id="S4T3U72">r</span></span>*<span class="var type1" id="S4T3U73">r</span></span></span> - <span class="mxinfo " id="T3:U59"><span class="mxinfo " id="T3:U60"><span class="mxinfo " id="T3:U61">(<span class="mxinfo " id="T3:U62">4/3</span>)*<span class="var type1" id="S4T3U81">r</span></span>*<span class="var type1" id="S4T3U82">r</span></span>*<span class="var type1" id="S4T3U83">r</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T3:U66"><span class="var type1" id="S3T3U86">dwdr</span> = <span class="mxinfo " id="T3:U68"><span class="mxinfo " id="T3:U69"><span class="mxinfo " id="T3:U70">-<span class="mxinfo " id="T3:U71">4</span></span>  + <span class="mxinfo " id="T3:U72"><span class="mxinfo " id="T3:U73">8</span>*<span class="var type1" id="S4T3U93">r</span></span></span> - <span class="mxinfo " id="T3:U75"><span class="mxinfo " id="T3:U76"><span class="mxinfo " id="T3:U77">4</span>*<span class="var type1" id="S4T3U97">r</span></span>*<span class="var type1" id="S4T3U98">r</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,10" id="srcline10">10</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="33,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T3:U80"><span class="var type1" id="S2T3U102">w</span>    = <span class="mxinfo " id="T3:U82">0.0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T3:U83"><span class="var type1" id="S3T3U106">dwdr</span> = <span class="mxinfo " id="T3:U85">0.0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="33,13" id="srcline13">13</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
